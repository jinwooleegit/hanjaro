# 한자로(Hanjaro) 웹 애플리케이션 문제 해결 가이드

## 목차
1. [JSON 파싱 오류 문제](#1-json-파싱-오류-문제)
2. [빌드 캐시 관련 문제](#2-빌드-캐시-관련-문제)
3. [파일 시스템 접근 오류](#3-파일-시스템-접근-오류)
4. [한자 데이터베이스 구조 문제](#4-한자-데이터베이스-구조-문제)
5. [포트 충돌 문제](#5-포트-충돌-문제)
6. [이미지 설정 경고](#6-이미지-설정-경고)
7. [필순 연습 구현 문제](#7-필순-연습-구현-문제)
8. [개발 서버 안정성 문제](#8-개발-서버-안정성-문제)
9. [URL 인코딩 및 한자 처리](#9-url-인코딩-및-한자-처리)
10. [Next.js 버전 호환성 문제](#10-nextjs-버전-호환성-문제)

## 1. JSON 파싱 오류 문제

### 문제
한자 데이터베이스 파일을 불러올 때 JSON 파싱 오류가 발생합니다.

### 원인
`hanja_database.json` 파일에서 JSON 구조가 잘못되어 있습니다. 특히 674번 라인에서 `level1` 배열이 제대로 닫히지 않은 상태에서 `level4` 객체가 시작되어 "Expected ',' or ']' after array element in JSON at position 22396" 오류가 발생합니다. 또한 파일 내에 주석(comments)이 포함되어 있는데, JSON은 주석을 허용하지 않습니다.

### 해결 방법
1. JSON 형식을 엄격하게 준수하도록 수정
   ```json
   "level1": [
     { ... },
     { ... }
   ], // 닫는 괄호와 쉼표 추가
   "level4": { ... }
   ```

2. 주석 제거 또는 유효한 데이터로 대체
   ```json
   // 이렇게 주석이 있으면 안 됨
   "characters": [] // 대신 빈 배열이나 실제 데이터 사용
   ```

3. JSON 유효성 검사 도구 사용
   - [JSONLint](https://jsonlint.com/)와 같은 온라인 검증 도구로 파일 검사
   - VS Code의 JSON 유효성 검사 기능 활용

## 2. 빌드 캐시 관련 문제

### 문제
`.next` 디렉토리와 관련된 지속적인 오류로 개발 서버가 불안정해집니다.

### 원인
Next.js의 빌드 캐시 디렉토리인 `.next`에서 파일 접근 권한 문제가 발생하고 있습니다. 이는 Windows 환경에서 파일 잠금이나 권한 문제로 인한 것일 수 있습니다.

### 해결 방법
1. 캐시 디렉토리를 완전히 삭제하고 재생성
   ```bash
   Remove-Item -Recurse -Force .next
   # 또는
   npm run dev # 새로 시작하여 재생성
   ```

2. `next.config.js`에서 캐시 디렉토리 경로 변경
   ```javascript
   module.exports = {
     distDir: '.next-custom',
     // 기타 설정...
   }
   ```

3. 빌드/개발 서버 시작 전에 자동으로 캐시를 정리하는 스크립트 추가
   ```json
   // package.json
   "scripts": {
     "clean": "rimraf .next-custom",
     "dev": "npm run clean && next dev",
     "build": "npm run clean && next build"
   }
   ```

4. 필요한 패키지 설치
   ```bash
   npm install rimraf --save
   ```

## 3. 파일 시스템 접근 오류

### 문제
"UNKNOWN: unknown error, open" 오류가 계속 발생합니다.

### 원인
Windows 환경에서 파일 잠금 메커니즘 때문에 발생합니다. Next.js가 빌드 중에 생성한 파일에 접근하려고 할 때, 해당 파일이 다른 프로세스에 의해 잠겨 있거나 접근 권한이 없을 때 발생합니다.

### 해결 방법
1. 모든 Node.js 프로세스 종료
   ```bash
   taskkill /f /im node.exe
   ```

2. 캐시 디렉토리 삭제
   ```bash
   Remove-Item -Recurse -Force .next-custom
   ```

3. `next.config.js`에서 캐시 설정 최적화
   ```javascript
   module.exports = {
     distDir: '.next-custom',
     onDemandEntries: {
       // 개발 모드에서 서버 사이드 렌더링 페이지를 메모리에 유지하는 시간(ms)
       maxInactiveAge: 60 * 1000,
       // 한 번에 메모리에 유지할 페이지 수
       pagesBufferLength: 5,
     },
     webpack: (config, { dev }) => {
       // 개발 모드에서 웹팩 캐시 비활성화
       if (dev) {
         config.cache = false;
       }
       return config;
     },
   }
   ```

4. 서버 실행 시 개별 포트 지정
   ```bash
   npx next dev -p 3009
   ```

## 4. 한자 데이터베이스 구조 문제

### 문제
한자 데이터베이스의 구조적 오류로 인해 데이터를 제대로 로드할 수 없습니다.

### 원인
데이터베이스 JSON 파일이 일관되지 않은 구조를 가지고 있으며, JSON 형식 규칙을 준수하지 않습니다.

### 해결 방법
1. JSON 형식을 엄격하게 준수하도록 수정
   - 모든 배열과 객체가 제대로 열리고 닫히는지 확인
   - 배열 요소 사이에 쉼표 확인
   - 주석 제거

2. 데이터 구조 일관성 유지
   ```json
   {
     "level1": {
       "total_characters": 100,
       "characters": [
         {
           "char": "水",
           "meaning": "물 수",
           "pronunciation": "수",
           "strokes": 4,
           "radical": "水",
           "examples": [
             {"word": "水中", "meaning": "수중", "pronunciation": "수중"}
           ]
         }
       ]
     },
     "level2": {
       // 동일한 구조 유지
     }
   }
   ```

3. 동적 데이터 로딩 구현
   - 필요한 레벨의 데이터만 로드하도록 최적화
   - 각 레벨별로 파일 분리 고려

## 5. 포트 충돌 문제

### 문제
"Error: listen EADDRINUSE: address already in use :::3009" 오류가 발생합니다.

### 원인
포트(3009)가 이미 다른 프로세스에 의해 사용 중입니다.

### 해결 방법
1. 실행 중인 서버 프로세스 종료
   ```bash
   taskkill /f /im node.exe
   ```

2. 다른 포트 번호 사용
   ```bash
   npx next dev -p 3010
   ```

3. `package.json`에 다양한 포트 옵션 추가
   ```json
   "scripts": {
     "dev": "npm run clean && next dev",
     "dev:port3010": "npm run clean && next dev -p 3010",
     "dev:port3020": "npm run clean && next dev -p 3020"
   }
   ```

4. 시스템 재부팅 후 재시도 (마지막 수단)

## 6. 이미지 설정 경고

### 문제
이미지 로드 중 경고 메시지가 발생합니다.

### 원인
이미지 로드 과정에서 문제가 발생할 수 있습니다.

### 해결 방법
1. 이미지 로드 중 발생하는 경고 메시지 확인
   - 콘솔 로그 확인

2. 이미지 로드 중 발생하는 오류 원인 파악
   - 네트워크 연결 확인
   - 서버 응답 상태 확인

3. 이미지 로드 중 발생하는 오류 원인 해결
   - 이미지 로드 중 발생하는 오류 원인 해결

## 7. 필순 연습 구현 문제

### 문제
필순 연습 구현 중 문제가 발생합니다.

### 원인
필순 연습 구현 중 문제가 발생할 수 있습니다.

### 해결 방법
1. 필순 연습 구현 중 발생하는 문제 파악
   - 코드 로그 확인

2. 필순 연습 구현 중 발생하는 문제 원인 파악
   - 코드 로그 확인

3. 필순 연습 구현 중 발생하는 문제 해결
   - 필순 연습 구현 중 발생하는 문제 해결

## 8. 개발 서버 안정성 문제

### 문제
개발 서버가 불안정해집니다.

### 원인
개발 서버가 불안정해질 수 있습니다.

### 해결 방법
1. 개발 서버가 불안정해질 수 있는 원인 파악
   - 코드 로그 확인

2. 개발 서버가 불안정해질 수 있는 원인 해결
   - 개발 서버가 불안정해질 수 있는 원인 해결

## 9. URL 인코딩 및 한자 처리

### 문제
URL 인코딩 및 한자 처리 중 문제가 발생합니다.

### 원인
URL 인코딩 및 한자 처리 중 문제가 발생할 수 있습니다.

### 해결 방법
1. URL 인코딩 및 한자 처리 중 발생하는 문제 파악
   - 코드 로그 확인

2. URL 인코딩 및 한자 처리 중 발생하는 문제 원인 파악
   - 코드 로그 확인

3. URL 인코딩 및 한자 처리 중 발생하는 문제 해결
   - URL 인코딩 및 한자 처리 중 발생하는 문제 해결

## 10. Next.js 버전 호환성 문제

### 문제
Next.js 버전 호환성 문제로 인해 애플리케이션이 제대로 작동하지 않습니다.

### 원인
Next.js 버전 호환성 문제로 인해 애플리케이션이 제대로 작동하지 않습니다.

### 해결 방법
1. Next.js 버전 호환성 문제로 인해 발생하는 문제 파악
   - 코드 로그 확인

2. Next.js 버전 호환성 문제로 인해 발생하는 문제 원인 파악
   - 코드 로그 확인

3. Next.js 버전 호환성 문제로 인해 발생하는 문제 해결
   - Next.js 버전 호환성 문제로 인해 발생하는 문제 해결 